(this["webpackJsonpdemo-realtime-etl"]=this["webpackJsonpdemo-realtime-etl"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),i=n.n(c),o=(n(104),n(105),n(12)),s=n(7),u=n.n(s),l=n(18),b=n(9),d=n(16),p=n(211),j=n(229),f=n(208),O=n(213),h=n(2),m=Object(f.a)((function(){return{header:{marginBottom:"2rem",textAlign:"center"},logo:{height:"28px",padding:"1rem 0 2.5rem",width:"auto"}}})),x=function(e){var t=e.title,n=e.justifyValue,a=void 0===n?"center":n,r=e.typographyVariant,c=void 0===r?"h3":r,i=e.gridDirectionValue,o=void 0===i?"row":i,s=e.component,u=void 0===s?"h1":s;m();return Object(h.jsx)(p.a,{container:!0,direction:o,justify:a,alignItems:"flex-start",children:Object(h.jsx)(O.a,{variant:c,component:u,children:t})})},g=n(61),y=function(e){var t=e.chartData,n=e.parserType,r=void 0===n?"":n,c=e.chartText,i=Object(a.useRef)(null),o=Object(a.useRef)(null);Object(a.useEffect)((function(){i.current&&(i.current.data.labels=[],i.current.data.datasets[0].data=t,i.current.update())}),[i,t]),Object(a.useEffect)((function(){if(!i.current&&o.current){var e={xAxisKey:"total_amount",yAxisKey:"client_name"};"companyTotals"===r&&(e.yAxisKey="product_company"),"categoryTotals"===r&&(e.yAxisKey="product_category_name"),o.current.setAttribute("height","200%"),i.current=new g.a(o.current,{type:"bar",elements:{bar:{}},data:{datasets:[{label:"Totals",data:t,backgroundColor:["#338AD0"]}]},options:{maintainAspectRatio:!0,responsive:!0,indexAxis:"y",parsing:e,animations:!0,scales:{x:{grid:{display:!1},ticks:{autoSkip:!1}},y:{grid:{display:!1},ticks:{autoSkip:!1}}},plugins:{title:{text:c,position:"bottom",display:!0,font:{size:16,weight:"bold"}},legend:{display:!1}}}})}}),[t,r,c]);var s=Object(a.useMemo)((function(){return Object(h.jsx)("canvas",{ref:o})}),[]);return Object(h.jsx)("div",{id:"chart",children:s})},v=function(e){var t=e.topN,n=e.handleTopN,r=e.clientTotals,c=e.companyTotals,i=e.categoryTotals,o=Object(a.useMemo)((function(){return Object(h.jsx)(p.a,{item:!0,children:Object(h.jsx)(y,{chartData:c,parserType:"companyTotals",chartText:"Merchant Totals($)"})})}),[c]),s=Object(a.useMemo)((function(){return Object(h.jsx)(p.a,{item:!0,children:Object(h.jsx)(y,{chartData:i,parserType:"categoryTotals",chartText:"Category Totals($)"})})}),[i]),u=Object(a.useMemo)((function(){return Object(h.jsx)(p.a,{item:!0,children:Object(h.jsx)(y,{chartData:r,parserType:"clientTotals",chartText:"Purchaser Totals($)"})})}),[r]),l=Object(a.useMemo)((function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(p.a,{item:!0,style:{marginRight:"10px"},children:Object(h.jsx)(x,{title:"TopN",justifyValue:"center",typographyVariant:"h6"})}),Object(h.jsx)(p.a,{item:!0,children:Object(h.jsx)(j.a,{id:"outlined-basic",label:"TopN",variant:"outlined",size:"small",onChange:n,value:t})})]})}),[t,n]);return Object(h.jsxs)("div",{style:{marginLeft:"3vw",marginRight:"3vw"},children:[Object(h.jsx)(p.a,{container:!0,direction:"row",justify:"flex-start",style:{paddingTop:"30px"},children:l}),Object(h.jsxs)(p.a,{container:!0,spacing:5,children:[Object(h.jsx)(p.a,{item:!0,xs:4,children:u}),Object(h.jsx)(p.a,{item:!0,xs:4,children:o}),Object(h.jsx)(p.a,{item:!0,xs:4,children:s})]})]})},T=n(17),C=n(217),S=n(218),k=Object(f.a)((function(){return{submitButton:{textTransform:"capitalize",backgroundColor:"rgba(211,225,240,1)",marginRight:"20px",width:"100%",fontFamily:"Lato",fontWeight:"900",color:"rgba(0,0,0,1)",fontSize:"16px"}}})),_=function(e){e.directionValue,e.gridStyle,e.justifyValue,e.alignItemsValue;var t=e.buttonVariant,n=void 0===t?"contained":t,a=e.buttonType,c=void 0===a?"submit":a,i=e.onClickCb,o=e.disableButton,s=e.buttonText,u=e.loading,l=(e.smValue,e.buttonStyle),b=void 0===l?{}:l,d=e.id,p=k();return Object(h.jsx)(r.a.Fragment,{children:Object(h.jsx)(C.a,{id:d,variant:n,type:c,fullWidth:!0,onClick:i,className:p.submitButton,color:"default",disabled:o,style:b,children:u?Object(h.jsx)(S.a,{size:30}):s})})},w=Object(f.a)((function(e){return{gridContainer:Object(T.a)({width:"20%",margin:"auto"},e.breakpoints.up("lg"),{flexWrap:"nowrap",width:"25%",margin:"auto"})}})),E=function(e){var t=e.isStartLoading,n=e.isStopLoading,a=e.isClearLoading,r=e.handleOnStart,c=e.handleOnStop,i=e.handleClearTables,o=w();return Object(h.jsxs)(p.a,{container:!0,spacing:3,className:o.gridContainer,children:[Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Start",buttonType:"primary",smValue:12,id:"start",disableButton:t||n||a,loading:t,onClickCb:r,buttonStyle:{marginRight:"20px"}})}),Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Stop",buttonType:"primary",id:"stop",smValue:12,disableButton:t||n||a,loading:n,onClickCb:c,buttonStyle:{marginRight:"20px"}})}),Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Clear",buttonType:"primary",smValue:12,id:"clear-tables",disableButton:t||n||a,loading:a,onClickCb:i,buttonStyle:{marginRight:"20px"}})})]})},N=n(34),A=n.n(N),D=function(e,t,n,a){var r=t;A.a.isEmpty(e)||r.push(e),r.sort((function(e,t){return t.total_amount-e.total_amount}));var c=A.a.uniqBy(r,n),i=[];return c.length>a&&(i=c.slice(0,a)),{updatedBankClientsTotals:i}},P=n(90),R=["etl-bank-totals","etl-bank-txns","etl-bank-txn-publisher","etl-bank-subscriptions","etl-bank-subscriptions-publisher"],B=["etl_bank_category_totals","etl_bank_client_totals","etl_bank_company_totals","etl_bank_subscriptions","etl_bank_transactions","etl_bank_transactions_anonymization"],L=new(n.n(P).a)({url:Object({NODE_ENV:"production",PUBLIC_URL:"/demo-realtime-etl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GDN_URL,apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"/demo-realtime-etl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_KEY,fabricName:Object({NODE_ENV:"production",PUBLIC_URL:"/demo-realtime-etl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_FABRIC_NAME}),F=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.prev=1,e.next=4,L.executeRestql(t,n);case 4:return a=e.sent,e.abrupt("return",a.result);case 8:return e.prev=8,e.t0=e.catch(1),console.error("error",e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(B.map(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.collection(t).truncate();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("the error is",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],R.forEach((function(e){n.push(L.activateStreamApp(e,t))})),e.next=5,Promise.all(n);case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),console.log("error 502",e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=L.stream(t,!1),e.next=4,n.getOtp();case 4:return a=e.sent,(r=n.consumer("etl-streams-".concat(Math.round(1e3*Math.random())),Object({NODE_ENV:"production",PUBLIC_URL:"/demo-realtime-etl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GDN_URL.replace("https://",""),{otp:a})).on("open",(function(){console.log("Connection open for _clientConsumer ")})),r.on("close",(function(){console.log("Connection close for _clientConsumer ")})),e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(0),console.error("error",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],a=0;a<10;a++)n[a]=F(t,{offsetValue:100*a});return e.next=4,Promise.all(n);case 4:return r=e.sent,(c=r.reduce((function(e,t){return e.push.apply(e,Object(b.a)(t)),e}),[])).sort((function(e,t){return e.id.localeCompare(t.id)})),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=["EtlBankClientNameTotalStream","EtlBankCompanyNameTotalStream","EtlBankCategoryNameTotalStream"],H=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)([]),s=Object(d.a)(i,2),p=s[0],j=s[1],f=Object(a.useState)([]),O=Object(d.a)(f,2),m=O[0],x=O[1],g=Object(a.useState)([]),y=Object(d.a)(g,2),T=y[0],C=y[1],S=Object(a.useState)(!1),k=Object(d.a)(S,2),_=k[0],w=k[1],N=Object(a.useState)(!1),P=Object(d.a)(N,2),R=P[0],B=P[1],L=Object(a.useState)(!1),I=Object(d.a)(L,2),H=I[0],z=I[1],U=Object(a.useState)(7),J=Object(d.a)(U,2),$=J[0],q=J[1],Y=Object(a.useRef)(null);Object(a.useEffect)((function(){F("getBankClientTotals",{topN:$}).then((function(e){j((function(){return Object(b.a)(e)}))}))}),[$]),Object(a.useEffect)((function(){F("getBankCompanyTotals",{topN:$}).then((function(e){x((function(){return Object(b.a)(e)}))}))}),[$]),Object(a.useEffect)((function(){F("getBankCategoryTotals",{topN:$}).then(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c((function(){return Object(b.a)(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[$]),Object(a.useEffect)((function(){Y.current=$}),[$]);var G=function(e){return e.preventDefault(),ae(),e.returnValue="",""};Object(a.useEffect)((function(){return window.addEventListener("beforeunload",G),function(){window.removeEventListener("beforeunload",G)}}),[]);var Q=Object(a.useCallback)(Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:return e.next=4,M();case 4:w(!1),j((function(){return[]})),c((function(){return[]})),x((function(){return[]}));case 8:case"end":return e.stop()}}),e)}))),[]),X=Object(a.useCallback)(Object(l.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(o.a)(T),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return a=n.value,e.next=7,a.terminate();case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:return e.prev=17,e.next=20,W(!1);case 20:z(!1),e.next=27;break;case 23:e.prev=23,e.t1=e.catch(17),console.error("error",e.t1),z(!1);case 27:case"end":return e.stop()}}),e,null,[[1,11,14,17],[17,23]])}))),[T]),Z=function(e){var t=function(e){var t=JSON.parse(e).payload,n=JSON.parse(e).messageId,a=atob(t);return 0===a.length?{newData:{},messageId:n}:{newData:JSON.parse(a),messageId:n}}(e).newData;if(t.hasOwnProperty("client_name")){var a=D(t,p,"client_name",Y.current).updatedBankClientsTotals;j((function(){return Object(b.a)(a)}))}else if(t.hasOwnProperty("product_company")){var r=D(t,m,"product_company",Y.current).updatedBankClientsTotals;x((function(){return Object(b.a)(r)}))}else if(t.hasOwnProperty("product_category_name")){var i=D(t,n,"product_category_name",Y.current).updatedBankClientsTotals;c((function(){return Object(b.a)(i)}))}},ee=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(!0);case 2:t=A.a.cloneDeep(T),n=u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(K[n]);case 2:t[n]=e.sent,t[n].on("message",(function(e){t[n].send(JSON.stringify({messageId:JSON.parse(e).messageId})),Z(e)}));case 4:case"end":return e.stop()}}),e)})),a=0;case 5:if(!(a<3)){e.next=10;break}return e.delegateYield(n(a),"t0",7);case 7:a++,e.next=5;break;case 10:C((function(e){return[].concat(Object(b.a)(T),Object(b.a)(t))})),B(!1);case 12:case"end":return e.stop()}}),e)}))(),"t0",2);case 2:e.next=8;break;case 4:e.prev=4,e.t1=e.catch(0),console.error("error",e.t1),z(!1);case 8:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(){return e.apply(this,arguments)}}(),te=Object(a.useCallback)((function(e){var t=e.target.value.replace(/[^0-9]/g,"");j([]),c([]),x([]),q(Number(t))}),[]),ne=Object(a.useCallback)((function(){w(!0),Q()}),[Q]),ae=function(){z(!0),X()},re=Object(a.useMemo)((function(){return Object(h.jsx)(v,{handleTopN:te,topN:$,clientTotals:p,companyTotals:m,categoryTotals:n})}),[te,$,p,m,n]);return Object(h.jsxs)(r.a.Fragment,{children:[Object(h.jsx)(E,{handleOnStart:function(){B(!0),ee()},handleOnStop:ae,handleClearTables:ne,isStartLoading:R,isStopLoading:H,isClearLoading:_}),re]})},z=Object(f.a)((function(){return{titleStyle:{fontWeight:"700",wordSpacing:"0.5",color:"black"},content:{textAlign:"center",padding:"20px"},subtitle:{width:"30%",margin:"auto",lineHeight:"1.2"}}})),U=function(){var e=z();return Object(h.jsxs)(p.a,{className:e.content,children:[Object(h.jsx)(O.a,{variant:"h4",className:e.titleStyle,children:"Macrometa Streaming ETL"}),Object(h.jsx)(O.a,{variant:"h6",className:e.subtitle,children:"Real time ETL with Stream Workers & Query Workers for synthetic bank data"})]})},J=function(){return Object(h.jsxs)(r.a.Fragment,{children:[Object(h.jsx)("div",{style:{position:"absolute",right:"10px",top:"10px"},children:Object(h.jsx)(_,{buttonText:"About",id:"about",onClickCb:function(){window.open("https://github.com/Macrometacorp/demo-realtime-etl/blob/main/README.md","_blank")}})}),Object(h.jsx)(U,{})]})},$=n(4),q=n(216),Y=n(223),G=n(224),Q=n(225),X=n(221),Z=n(222),ee=n(228),te=n(23),ne=n(14),ae=n(219),re=n(92),ce=Object(f.a)((function(e){return{root:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1),maxHeight:"80px"},formControl:{margin:e.spacing(1),minWidth:120},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(ne.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},title:{flex:"1 1 100%"}}})),ie=function(e){var t=e.bankClientNames,n=(e.isLoading,e.selectedClient),a=e.handleSelectClient,r=ce(),c={control:function(e){return Object(te.a)(Object(te.a)({},e),{},{backgroundColor:"white"})},option:function(e,t){t.data,t.isDisabled,t.isFocused,t.isSelected;return Object(te.a)(Object(te.a)({},e),{},{color:"rgba(105,105,105,0.6)",fontFamily:"Lato",fontWeight:"600"})},placeholder:function(e){return Object(te.a)(Object(te.a)({},e),{},{color:"rgba(105,105,105,0.8)",fontFamily:"Lato",fontWeight:"700"})}};return Object(h.jsx)(ae.a,{className:Object($.a)(r.root),style:{backgroundColor:"rgba(51,138,208,0.6)"},children:Object(h.jsxs)(p.a,{container:!0,children:[Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(re.a,{options:t,styles:c,value:n,onChange:a,getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.id},placeholder:n||"Client Name"})}),Object(h.jsx)(p.a,{item:!0,xs:8,style:{justifyContent:"center",alignItems:"center",textAlign:"center"},children:Object(h.jsx)("span",{style:{fontWeight:"500",fontSize:"24px",fontFamily:"Lato",color:"rgba(0,0,0,0.8)",marginTop:"24px",marginLeft:"-180px"},children:"Client Data"})})]})})},oe=n(220),se=function(e){var t=e.tableType,n=[{id:"client_name",numeric:!1,disablePadding:!0,label:"Client Name"},{id:"Subscriptions"!==t?"date":"date_start",numeric:!0,disablePadding:!1,label:"Subscriptions"!==t?"Date":"Start Date"},{id:"Subscriptions"!==t?"txn_id":"date_end",numeric:!0,disablePadding:!0,label:"Subscriptions"!==t?"Transaction Id":"End Date"},{id:"product_category_name",numeric:!0,disablePadding:!0,label:"Product Category Name"},{id:"amount",numeric:!0,disablePadding:!1,label:"Amount"}];return Object(h.jsx)(oe.a,{children:Object(h.jsx)(X.a,{children:n.map((function(e){return Object(h.jsx)(Z.a,{align:"center",padding:e.disablePadding?"none":"default",style:{fontSize:"16px",fontWeight:"900",fontFamily:"Lato",color:"rgb(105,105,105)"},children:e.label},e.id)}))})})},ue=Object(f.a)((function(e){return{root:{width:"100%","& .MuiTableCell-root":{border:" 1px solid rgba(224, 224, 224, 1)"}},paper:{width:"100%",marginBottom:e.spacing(2)},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}}}));function le(e){var t=e.bankClientNames,n=e.selectedClient,r=e.handleSelectClient,c=e.tableData,i=e.tableType,o=e.isLoading,s=ue(),u=Object(a.useState)(0),l=Object(d.a)(u,2),b=l[0],p=l[1],j=Object(a.useState)(5),f=Object(d.a)(j,2),m=f[0],x=f[1],g=function(e,t){p(t)},y=function(e){x(parseInt(e.target.value,10)),p(0)},v=c&&c.length&&m-Math.min(m,c.length-b*m),T=Object(a.useMemo)((function(){return Object(h.jsxs)(q.a,{className:s.paper,children:[Object(h.jsx)(ie,{tableType:i,bankClientNames:t,selectedClient:n,handleSelectClient:r,isLoading:o}),Object(h.jsx)(Y.a,{children:Object(h.jsxs)(G.a,{"aria-labelledby":"tableTitle",size:"medium","aria-label":"enhanced table",children:[Object(h.jsx)(se,{tableType:i}),Object(h.jsxs)(Q.a,{children:[c&&c.length?c.slice(b*m,b*m+m).map((function(e,t){var n="enhanced-table-checkbox-".concat(t);return Object(h.jsxs)(X.a,{hover:!0,role:"checkbox",tabIndex:-1,children:[Object(h.jsx)(Z.a,{component:"th",id:n,scope:"row",padding:"none",align:"center",children:e.client_name}),Object(h.jsx)(Z.a,{align:"center",children:"Subscriptions"!==i?e.date:e.date_start}),Object(h.jsx)(Z.a,{align:"center",children:"Subscriptions"!==i?e.txn_id:e.date_end}),Object(h.jsx)(Z.a,{align:"center",children:e.product_category_name}),Object(h.jsx)(Z.a,{align:"center",children:e.amount})]},e._key)})):o?Object(h.jsx)(X.a,{children:Object(h.jsx)(Z.a,{align:"center",colSpan:6,children:Object(h.jsx)(S.a,{size:30})})}):Object(h.jsx)(X.a,{children:Object(h.jsx)(Z.a,{align:"center",colSpan:6,children:Object(h.jsx)("div",{style:{justifyContent:"center",alignContent:"center"},children:Object(h.jsx)(O.a,{variant:"h6",align:"center",style:{color:"rgb(105, 105, 105)"},children:"No Data"})})})}),v>0&&Object(h.jsx)(X.a,{style:{height:53*v},children:Object(h.jsx)(Z.a,{colSpan:6})})]})]})}),Object(h.jsx)(ee.a,{rowsPerPageOptions:[5],component:"div",count:c&&c.length,rowsPerPage:m,page:b,onChangePage:g,onChangeRowsPerPage:y})]})}),[v,t,o,s,r,b,m,n,c,i]);return Object(h.jsx)("div",{className:s.root,style:{marginTop:"2vh"},children:T})}var be=function(e){var t=e.chartData,n=Object(a.useRef)(null),r=Object(a.useRef)(null);Object(a.useEffect)((function(){n.current&&(n.current.data.datasets[0].data=t,n.current.update())}),[n,t]),Object(a.useEffect)((function(){!n.current&&r.current&&(n.current=new g.a(r.current,{type:"pie",data:{labels:["Merchant Totals($)","Category Totals($)","Purchaser Totals($)"],datasets:[{label:"Totals",data:t,backgroundColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 205, 86)"],hoverOffset:4}]},options:{plugins:{title:{text:"Totals",display:!0,position:"bottom",font:{size:16,weight:"bold"}},legend:{position:"bottom"}}}}))}),[t]);var c=Object(a.useMemo)((function(){return Object(h.jsx)("canvas",{ref:r})}),[]);return Object(h.jsx)("div",{id:"chart",children:c})},de=function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])},pe=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(d.a)(c,2),o=i[0],s=i[1],j=Object(a.useState)([]),f=Object(d.a)(j,2),m=f[0],x=f[1],g=Object(a.useState)([]),y=Object(d.a)(g,2),v=y[0],T=y[1],C=Object(a.useState)("Transactions"),S=Object(d.a)(C,2),k=S[0],w=S[1],E=Object(a.useState)([0,0,0]),N=Object(d.a)(E,2),D=N[0],P=N[1],R=Object(a.useState)(!1),B=Object(d.a)(R,2),L=B[0],M=B[1],W=Object(a.useCallback)(Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(v.length>=500)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,I("getBankAnonymizationClient");case 4:t=e.sent,n=A.a.uniqBy(t,"id"),T((function(){return Object(b.a)(n)}));case 7:case"end":return e.stop()}}),e)}))),[v.length]),V=Object(a.useCallback)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F("getTotals");case 2:t=e.sent,P((function(){return Object(b.a)(t)}));case 4:case"end":return e.stop()}}),e)}))),[]);Object(a.useEffect)((function(){(function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I("getBankClients");case 2:t=e.sent,x((function(){return Object(b.a)(t)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.useEffect)((function(){W()}),[W]),Object(a.useEffect)((function(){V()}),[V]),de(W,5e3),de(V,3e4);var K=Object(a.useCallback)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],e.prev=1,e.t0=k,e.next="Transactions"===e.t0?5:"Subscriptions"===e.t0?9:"Anonymous"===e.t0?13:17;break;case 5:return e.next=7,F("getBanksTxnsByClient",{clientName:o});case 7:return t=e.sent,e.abrupt("break",21);case 9:return e.next=11,F("getBankSubscriptionsByClient",{clientName:o});case 11:return t=e.sent,e.abrupt("break",21);case 13:return e.next=15,F("getBankTxnsByAnnonymousClient",{clientName:o});case 15:return t=e.sent,e.abrupt("break",21);case 17:return e.next=19,F("getBanksTxnsByClient",{clientName:o});case 19:return t=e.sent,e.abrupt("break",21);case 21:r((function(){return Object(b.a)(t)})),M(!1),e.next=29;break;case 25:e.prev=25,e.t1=e.catch(1),console.error("error",e.t1),M(!1);case 29:case"end":return e.stop()}}),e,null,[[1,25]])}))),[k,o]);Object(a.useEffect)((function(){M(!0),K()}),[k,K,o]);var H=Object(a.useCallback)((function(e){w(e)}),[]),z=Object(a.useCallback)((function(e){s(e.id)}),[]),U=Object(a.useMemo)((function(){return Object(h.jsxs)(p.a,{container:!0,spacing:1,style:{width:"40%",flexWrap:"nowrap"},children:[Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Transactions",buttonType:"primary",smValue:12,id:"Transactions",onClickCb:function(){return H("Transactions")},buttonStyle:{backgroundColor:"Transactions"===k?"#338AD0":"rgba(211,225,240,1)"}})}),Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Subscriptions",buttonType:"primary",smValue:12,id:"Subscriptions",onClickCb:function(){return H("Subscriptions")},buttonStyle:{backgroundColor:"Subscriptions"===k?"#338AD0":"rgba(211,225,240,1)"}})}),Object(h.jsx)(p.a,{item:!0,xs:!0,children:Object(h.jsx)(_,{buttonText:"Anonymous",buttonType:"primary",smValue:12,id:"Anonymous",onClickCb:function(){return H("Anonymous")},buttonStyle:{backgroundColor:"Anonymous"===k?"#338AD0":"rgba(211,225,240,1)"}})})]})}),[H,k]),J=Object(a.useMemo)((function(){return Object(h.jsx)(le,{bankClientNames:"Anonymous"===k?v:m,selectedClient:o,handleSelectClient:z,tableData:n,tableType:k,isLoading:L})}),[m,v,n,k,L,o,z]);return Object(h.jsxs)(p.a,{container:!0,spacing:3,style:{padding:"3vw"},children:[Object(h.jsxs)(p.a,{item:!0,xs:9,children:[U,J]}),Object(h.jsx)(p.a,{item:!0,xs:3,children:0!==A.a.sum(D)?Object(h.jsx)(be,{chartData:D}):Object(h.jsx)(O.a,{variant:"h6",align:"center",children:"No Data to show for pie chart"})})]})},je=n(91),fe=n(226),Oe=Object(je.a)({overrides:{MuiFormControl:{root:{height:"56px"}},MuiInputBase:{root:{height:"30px",width:"60px"}},typography:{fontFamily:["Lato","sans-serif"].join(",")},MuiTypography:{h6:{fontSize:"16px"}}}});var he=function(){return Object(h.jsxs)(fe.a,{theme:Oe,children:[Object(h.jsx)(J,{}),Object(h.jsx)(H,{}),Object(h.jsx)(pe,{})]})},me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,231)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(he,{})}),document.getElementById("root")),me()}},[[173,1,2]]]);
//# sourceMappingURL=main.20a83772.chunk.js.map